This folder contains a set of Jupyter Notebooks for processing of dMRI files

## Organization and Anonymization of DCMs
Image data is exported from the MR-scanner (non-anonymized) to external HD where it is then organized and anonymized.  

This image is an overview of the process  
![image](https://user-images.githubusercontent.com/20419258/230000465-a31468eb-8eee-462a-8d1d-e6d0f656dd5c.png)

### Implementation
1. **Relevant imaging data is exported from MR-scanner to a DVD.**  
The DVD is marked `sID_ssID_number_DateMRI` where `sID` is the participants study ID (e.g. "001"), `ssID` is the session ID (which for the TEA-scan this is "MR1"), `number` is the study identifier (generated by the MR-scanner??), and `DateMRI` is the date of the MR-scan (e.g. "20230329"). The DVDs will thus serve as backups of the imaging data.  
2. **The DVD is transferred to (Kentaro's) external HD**  
The data is put in the folder `/KPUM_NODDI/DICOM_KPUM_NODDI/sID_ssID_number_DateMRI`. Currently, the KPUM_NODDI folder is a subfolder to `Finn`.

2. **Organization and anonymization of DCM images on the external HD**  
This will be done by the jupyter notebook `dicomdir2sourcedata.ipynb`  
The first cell in the ipynb-file is where user-input goes
  ```
  # User input
  subject = '0XX'
  session = 'MR1'
  inputdicomfolder = '0XX_8453727_20230329'
  ```


## Conversion into NIfTI (and NRRD) data
Anonymized DCM data is converted into NIfTI (and/or NRRD) data Image data from the MR-scanner is exported (non-anonymized) to external HD. This is then organized and anonymized.  

This image is an overview of the process  
![image](https://user-images.githubusercontent.com/20419258/230001015-97f8d736-0063-474d-afef-81a7a747f74d.png)  

### Implementation
This will be done by the jupyter notebook `sourcedata2nifti.ipynb`  
The first cell in the ipynb-file is where user-input goes
  ```
######################################################
# User input

subject = '010'
session = 'MR1'

# Define good DCM datafolder as input (and if no data is not good enough, leave blank)
dki_dirAP = 's16_DKI_2.5mm_NODDI_73dir_0_1000_2000'
dki_dirAP_volb0 = ''

dki_dirPA = ''
dki_dirPA_volb0 = ''

t2w_mcrib = ''
t1w_mprage = 's05_MPRAGE'
```

## dMRI pipeline

### Implementation
This uses the notebook `dmri_preprocess.ipynb`  
Input:
Output:
